---
- name: Adding a self-hosted runner
  hosts: all
  become: true
  vars:
    pip_install_packages:
      - name: docker
      - name: jsondiff
    docker_install_compose: false
    docker_install_compose_plugin: true
  roles:
    - soramitsukhmer-lab.pip
    - soramitsukhmer-lab.docker
    - packages
  pre_tasks:
    - name: Install unzip
      ansible.builtin.package:
        name: unzip
        state: present
  tasks:
    - name: "Run docker system prune on weekly basis"
      ansible.builtin.cron:
        name: "Docker system prune"
        state: present
        special_time: "weekly"
        job: "docker system prune --all --volumes"
        user: github

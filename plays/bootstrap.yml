---
- name: Update and install prerequisite packages
  hosts: all
  become: true
  tasks:
    - name: Run the equivalent of "apt-get upgrade/update" as a separate step
      ansible.builtin.apt:
        upgrade: safe
    - name: Installing prerequisite packages
      ansible.builtin.apt:
        name:
          - unzip
        state: present
        update_cache: true

- name: Bootstrapping a self-hosted runner
  hosts: all
  become: true
  vars:
    pip_install_packages:
      - name: docker
      - name: jsondiff
    docker_install_compose: false
    docker_install_compose_plugin: true
  roles:
    - soramitsukhmer-lab.pip
    - soramitsukhmer-lab.docker
  tasks:
    - name: Installing Docker Extra Plugins
      ansible.builtin.apt:
        name:
          - "docker-buildx-plugin"
        state: present
        update_cache: true
